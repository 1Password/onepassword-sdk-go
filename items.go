// Code generated by op-codegen - DO NOT EDIT

package onepassword

import (
	"context"
	"encoding/json"

	"github.com/1password/onepassword-sdk-go/internal"
)

// The Items API holds all operations the SDK client can perform on 1Password items.
type ItemsSource struct {
	innerClient internal.InnerClient
	Shares      ItemsSharesSource
}

func NewItemsSource(inner internal.InnerClient) *ItemsSource {
	return &ItemsSource{innerClient: inner, Shares: *NewItemsSharesSource(inner)}
}

// Create a new item.
func (i ItemsSource) Create(ctx context.Context, params ItemCreateParams) (Item, error) {
	resultString, err := clientInvoke(ctx, i.innerClient, "ItemsCreate", map[string]interface{}{
		"params": params,
	})
	if err != nil {
		return Item{}, err
	}
	var result Item
	err = json.Unmarshal([]byte(*resultString), &result)
	if err != nil {
		return Item{}, err
	}
	return result, nil
}

// Get an item by vault and item ID
func (i ItemsSource) Get(ctx context.Context, vaultID string, itemID string) (Item, error) {
	resultString, err := clientInvoke(ctx, i.innerClient, "ItemsGet", map[string]interface{}{
		"vault_id": vaultID,
		"item_id":  itemID,
	})
	if err != nil {
		return Item{}, err
	}
	var result Item
	err = json.Unmarshal([]byte(*resultString), &result)
	if err != nil {
		return Item{}, err
	}
	return result, nil
}

// Update an existing item.
func (i ItemsSource) Put(ctx context.Context, item Item) (Item, error) {
	resultString, err := clientInvoke(ctx, i.innerClient, "ItemsPut", map[string]interface{}{
		"item": item,
	})
	if err != nil {
		return Item{}, err
	}
	var result Item
	err = json.Unmarshal([]byte(*resultString), &result)
	if err != nil {
		return Item{}, err
	}
	return result, nil
}

// Delete an item.
func (i ItemsSource) Delete(ctx context.Context, vaultID string, itemID string) error {
	_, err := clientInvoke(ctx, i.innerClient, "ItemsDelete", map[string]interface{}{
		"vault_id": vaultID,
		"item_id":  itemID,
	})
	return err
}

// Archive an item.
func (i ItemsSource) Archive(ctx context.Context, vaultID string, itemID string) error {
	_, err := clientInvoke(ctx, i.innerClient, "ItemsArchive", map[string]interface{}{
		"vault_id": vaultID,
		"item_id":  itemID,
	})
	return err
}

// List all items
func (i ItemsSource) ListAll(ctx context.Context, vaultID string) (*Iterator[ItemOverview], error) {
	resultString, err := clientInvoke(ctx, i.innerClient, "ItemsListAll", map[string]interface{}{
		"vault_id": vaultID,
	})
	if err != nil {
		return nil, err
	}
	var result []ItemOverview
	err = json.Unmarshal([]byte(*resultString), &result)
	if err != nil {
		return nil, err
	}
	return NewIterator(result), nil
}
